\subsection{Model-independent isobar decomposition}
\label{sec:model_independent_isobar_decomposition}

    The model-independent approach to the isobar decomposition aims to reduce the analysis dependence on possibly incomplete fit models, as no assumption on the resonant content of the isobars is needed.
    The shapes of the resonances are directly extracted from the available experimental events, provided the data set is large enough.
    

    A characteristic function\index{characteristic function} on an real interval $A \coloneqq [a,b)$ is defined as
    \begin{equation}
        \Characteristic_A(m) \coloneqq 
        \begin{cases}
            1 &\text{if }m \in A, \\
            0 &\text{otherwise}.
        \end{cases}
    \end{equation}
    Let $\mathcal{P}(A) \coloneqq \set{m_0, m_1,\dots, m_{N_\text{bins}}}$ be a partition of $A$, \ie~a set of points such that $m_{i} < m_{i+1}$; and whose extremes coincide with those of $A$, namely $(m_0, m_{N_\text{bins}}) = (a, b)$.
    \begin{figure}
        \centering
        \input{fig/mass_range_partitioning.pgf}
        \caption{Partition of the invariant-mass range, $A \coloneqq [m_a+m_b,m_X - m_c)$, into $N_\text{bins}$ right-open bins, $A_i = [m_i, m_{i+1})$.}
        \label{fig:invariant-mass-partition}
    \end{figure}
    The figure~\ref{fig:invariant-mass-partition} shows the partitioning of the interval $[m_a+m_b,m_X-m_c)$, the allowed invariant-mass range for the final state decay of the $ab$ system.\footnote{The $ab$ allowed mass range also includes the value $m_X - m_c$; I will anyway ignore this value as it is a null-measure interval, so leaving it out will not affect the results.}
    The partitioning $\mathcal{P}(A)$ defines $N_\text{bins}$ bins on $A$, $\set{B_i}$, where $B_i$ is the right-open interval $[m_{i-1},m_i)$ for $i\in\set{1,\dots, N_\text{bins}}$.
    A step function\index{step function} on the interval $A$, given the partition $\mathcal{P}(A)$ is a finite linear combination of characteristic functions on the bins:
    \begin{equation}\label{eq:step_dynamic_shape}
        \Delta_{\mathcal{P}(A)}^{\text{SF}}(m) \coloneqq \sum_{i = 1}^{N_\text{bins}} \alpha_i\, \Characteristic_{B_i}\!(m),
    \end{equation}
    being $a_i$'s complex parameters.


    In the model-independent isobar decomposition, the equation~\eqref{eq:step_dynamic_shape} is used as the dynamic shape of the isobar.
    The parameters are to be determined from an analysis of the observed events.
    \begin{figure}
        \centering
        \input{fig/nrbw_binning.pgf}
        \caption{Step-function approximation of the magnitude of the non-relativistic Breit-Wigner dynamic shape~\eqref{eq:bw}.}
        \label{fig:step_function_approximation}
    \end{figure}
    The figure~\ref{fig:step_function_approximation} shows the basic idea of the model-independent isobar decomposition: the step function~\eqref{eq:step_dynamic_shape} will approximate the isobar mass shape.


    The isobar amplitude now reads:
    \begin{equation}
        \Psi_I(\tau) = \psi_{J_I}\!(\tau) \sum_{i=1}^{N_\text{bins}} \gamma_{(I,i)}\, \Characteristic_{B_i}\!(s),
        \quad
        \text{being }
        \gamma_{(I,i)} \coloneqq c_I \alpha_i. 
    \end{equation}
    The free amplitudes, $\gamma_{(I,i)}$, now need to have an isobar label.
    This is called \emph{freed wave}\index{freed wave}.


    A straightforward drawback of the model-independent approach is the drastical increase of the fit complexity.
    Each bin introduces a complex fit parameter, for a total of $2N_{\text{bins}}$ real fit parameters.


    The model-independent formalism can easily be used together with the model-dependent one, to make the fits faster.

    At this point it is worth noting that this step-like description of the dynamic function of an isobar introduces $N_\text{bins}$ fit parameters, which drastically increases the complexity of fitting the model to the data.
    This problem can be partially solved considering that:
    \begin{itemize}
        \item 
            This formalism allows mixing fixed and freed resonance dynamic functions in a model, so that the number of free fit parameters can be somehow contained;
        \item
            The partition bins do not have to be uniform. By means of a non-uniform mass-range partition, making narrower bins in the mass interval where a resonance is expected, the number of necessary fit parameters can be optimized.
    \end{itemize}


    At this point it is worth noting that this step-like description of the dynamic function of an isobar introduces $N_\text{bins}$ fit parameters, which drastically increases the complexity of fitting the model to the data.
    This problem can be partially solved considering that:
    \begin{itemize}
        \item 
            This formalism allows mixing fixed and freed resonance dynamic functions in a model, so that the number of free fit parameters can be somehow contained;
        \item
            The partition bins do not have to be uniform. By means of a non-uniform mass-range partition, making narrower bins in the mass interval where a resonance is expected, the number of necessary fit parameters can be optimized.
    \end{itemize}

    {\color{red}
    (Quote Fabian's work as unpublished?)
    }


    The approach is flexible because it allows a mixed formalism.
    The \focus{} collaboration, for instance, used it to describe the S-wave component of a $\PKminus\Ppiplus$ system from a $\PDplus \to \PKminus\Ppiplus\Ppiplus$ decay while still using a model dependent description for P and D waves~\cite{Link200914}.
